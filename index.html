<!-- Замени этот блок в HEAD (стили) -->
<style>
    /* ... все стили до .code-input-wrapper остаются без изменений ... */
    
    .code-input-wrapper {
        position: relative;
        display: inline-block;
        width: 100%;
        margin: 15px 0;
    }
    
    .code-mask {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        color: #ff99aa;
        font-size: 24px;
        pointer-events: none;
        letter-spacing: 8px;
        font-family: 'Caveat', cursive;
        z-index: 1;
        text-shadow: 0 0 5px #ff3366;
        white-space: pre;
        opacity: 0.6; /* делаем маску полупрозрачной */
    }
    
    #codeInput {
        padding: 15px;
        font-size: 24px;
        background: #333;
        border: 2px solid #ff3366;
        border-radius: 10px;
        margin: 0;
        width: 280px;
        color: white; /* теперь текст виден! */
        outline: none;
        text-align: center;
        letter-spacing: 8px;
        font-family: 'Caveat', cursive;
        position: relative;
        z-index: 2;
        caret-color: #ff3366;
        font-weight: bold;
    }
    
    /* ... остальные стили без изменений ... */
</style>

<!-- И замени весь script полностью -->
<script>
    let currentLine = 0;
    const totalLines = 7;
    let heartRateInterval;
    
    // Функция для форматирования ввода даты
    document.getElementById('codeInput').addEventListener('input', function(e) {
        let value = e.target.value.replace(/[^\d]/g, ''); // оставляем только цифры
        
        // Ограничиваем длину
        if (value.length > 8) {
            value = value.slice(0, 8);
        }
        
        // Форматируем с точками
        let formatted = '';
        if (value.length > 0) {
            if (value.length <= 2) {
                formatted = value;
            } else if (value.length <= 4) {
                formatted = value.slice(0, 2) + '.' + value.slice(2);
            } else {
                formatted = value.slice(0, 2) + '.' + value.slice(2, 4) + '.' + value.slice(4, 8);
            }
        }
        
        e.target.value = formatted;
        
        // Обновляем маску (делаем её чуть темнее, чтобы цифры выделялись)
        const mask = document.getElementById('codeMask');
        let maskValue = formatted;
        if (maskValue.length < 10) { // 10 символов с точками
            // Добиваем подчеркиваниями
            const parts = maskValue.split('.');
            while (parts.length < 3) {
                parts.push('');
            }
            while (parts[0].length < 2) parts[0] += '_';
            while (parts[1].length < 2) parts[1] += '_';
            while (parts[2].length < 4) parts[2] += '_';
            maskValue = parts.join(' . ');
        }
        mask.textContent = maskValue;
    });
    
    function getRandomHeartRate() {
        return Math.floor(Math.random() * 6) + 120;
    }
    
    function updateHeartRate() {
        const heartRateElement = document.getElementById('heartRate');
        if (heartRateElement) {
            heartRateElement.textContent = getRandomHeartRate();
        }
    }
    
    function showLine(lineNumber) {
        const loveLetter = document.getElementById('loveLetter');
        const container = document.getElementById('messageBox').parentElement;
        
        loveLetter.classList.remove('expanded');
        container.classList.remove('expanded');
        
        for (let i = 1; i <= totalLines; i++) {
            const line = document.getElementById('line' + i);
            line.classList.remove('active', 'final-active');
        }
        
        if (lineNumber <= totalLines) {
            document.getElementById('line' + lineNumber).classList.add('active');
            currentLine = lineNumber;
            
            document.getElementById('prevBtn').disabled = (currentLine <= 1);
            document.getElementById('nextBtn').disabled = false;
            
            document.getElementById('progress').textContent = currentLine + ' / ' + totalLines;
            
            document.getElementById('signature').classList.add('hidden');
            document.getElementById('resetBtn').classList.add('hidden');
            document.getElementById('navButtons').classList.remove('hidden');
            document.getElementById('progress').classList.remove('hidden');
        }
    }
    
    function showAllLines() {
        const loveLetter = document.getElementById('loveLetter');
        const container = document.getElementById('messageBox').parentElement;
        
        loveLetter.classList.add('expanded');
        container.classList.add('expanded');
        
        for (let i = 1; i <= totalLines; i++) {
            const line = document.getElementById('line' + i);
            line.classList.remove('active');
            line.classList.add('final-active');
        }
        
        loveLetter.classList.add('all-lines');
        
        document.getElementById('navButtons').classList.add('hidden');
        document.getElementById('progress').classList.add('hidden');
        document.getElementById('signature').classList.remove('hidden');
        document.getElementById('resetBtn').classList.remove('hidden');
    }
    
    function nextLine() {
        if (currentLine < totalLines) {
            showLine(currentLine + 1);
        } else if (currentLine === totalLines) {
            showAllLines();
        }
    }
    
    function prevLine() {
        if (currentLine > 1) {
            showLine(currentLine - 1);
        }
    }
    
    function resetToFirstLine() {
        const loveLetter = document.getElementById('loveLetter');
        const container = document.getElementById('messageBox').parentElement;
        
        loveLetter.classList.remove('expanded', 'all-lines');
        container.classList.remove('expanded');
        
        showLine(1);
    }
    
    function checkCode() {
        const code = document.getElementById('codeInput').value;
        // Убираем точки для проверки
        const digitsOnly = code.replace(/\./g, '');
        if (digitsOnly === '11032025') {
            document.getElementById('loginBox').classList.add('hidden');
            document.getElementById('messageBox').classList.remove('hidden');
            
            if (heartRateInterval) clearInterval(heartRateInterval);
            heartRateInterval = setInterval(updateHeartRate, 500);
            
            showLine(1);
        } else {
            document.getElementById('error').style.display = 'block';
        }
    }

    function resetPage() {
        document.getElementById('loginBox').classList.remove('hidden');
        document.getElementById('messageBox').classList.add('hidden');
        document.getElementById('codeInput').value = '';
        document.getElementById('error').style.display = 'none';
        document.getElementById('codeMask').textContent = '__ . __ . ____';
        
        if (heartRateInterval) {
            clearInterval(heartRateInterval);
        }
        
        const loveLetter = document.getElementById('loveLetter');
        const container = document.getElementById('messageBox').parentElement;
        loveLetter.classList.remove('expanded', 'all-lines');
        container.classList.remove('expanded');
    }
</script>
